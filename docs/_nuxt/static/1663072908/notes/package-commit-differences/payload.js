__NUXT_JSONP__("/notes/package-commit-differences", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){return {data:[{slug:"package-commit-differences",body:{type:"root",children:[{type:b,tag:d,props:{},children:[{type:a,value:"More often than not when we prepare deployment packages we need to remember the files that we have created from a couple of commits back and the process is often tedious and prone to human error. Fortunately the process can be automated with a single Git command:"}]},{type:a,value:c},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,"language-bash"]},children:[{type:b,tag:j,props:{},children:[{type:b,tag:e,props:{className:[k,m]},children:[{type:a,value:o}]},{type:a,value:" archive --output"},{type:b,tag:e,props:{className:[k,p]},children:[{type:a,value:q}]},{type:a,value:"package.zip update_commit "},{type:b,tag:e,props:{className:[k,n]},children:[{type:b,tag:e,props:{className:[k,n]},children:[{type:a,value:"$("}]},{type:b,tag:e,props:{className:[k,m]},children:[{type:a,value:o}]},{type:a,value:" "},{type:b,tag:e,props:{className:[k,m]},children:[{type:a,value:"diff"}]},{type:a,value:" --name-only original_commit"},{type:b,tag:e,props:{className:[k,"punctuation"]},children:[{type:a,value:".."}]},{type:a,value:"update_commit --diff-filter"},{type:b,tag:e,props:{className:[k,p]},children:[{type:a,value:q}]},{type:a,value:"d"},{type:b,tag:e,props:{className:[k,n]},children:[{type:a,value:")"}]}]},{type:a,value:c}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"The Git command is made of two parts:"}]},{type:a,value:c},{type:b,tag:"ol",props:{},children:[{type:a,value:c},{type:b,tag:r,props:{},children:[{type:a,value:"Generate a list of files that have been created and modified between the two commits"}]},{type:a,value:c},{type:b,tag:r,props:{},children:[{type:a,value:"Archive the list of files in a zip folder"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"We shall use an example to illustrate what happens under the hood."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Assuming we have a directory called “DIFF” that has the following structure:"}]},{type:a,value:c},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,l]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"\u002FDIFF\u002F\n| — folder1\n| | — file1.txt\n|\n| — file2.txt\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"It has a folder called “folder1” in which a file “file1.txt” resides. There is also a file called “file2.txt” in the root folder.\nSuppose we have the first commit to create all the files. In the commit we create the following content in file1.txt and file2.txt:"}]},{type:a,value:c},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,l]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"## file1.txt has the following content:\nthis is file 1\n## file2.txt has the following content:\nthis is file 2\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Then we have the second commit that appends a new line to file1.txt:"}]},{type:a,value:c},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,l]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"## this is what file1.txt looks like after the second commit\nthis is file 1\nupdate file1.txt\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"And the third commit to appends a new line to file2.txt:"}]},{type:a,value:c},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,l]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"## this is what file2.txt looks like after the third commit\nthis is file 2\nupdate file2.txt\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"The commit history is"}]},{type:a,value:c},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,l]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"c2505fe (HEAD -\u003E master) update file2\nc780650 update file1\nf3f57c9 initial commit\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Our goal is to generate a zip file called “deployment-v1” that includes the changes from first to third commit."}]},{type:a,value:c},{type:b,tag:s,props:{id:"generate-the-list-of-new-and-modified-files"},children:[{type:b,tag:t,props:{ariaHidden:u,href:"#generate-the-list-of-new-and-modified-files",tabIndex:v},children:[{type:b,tag:e,props:{className:[w,x]},children:[]}]},{type:a,value:"Generate the list of new and modified files"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"The first half of the command obtains a list of all new or modified files between two commits. Since we know the starting point is the commit with ID f3f57c9 and the ending point is HEAD, we can have our first half:"}]},{type:a,value:c},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,l]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"git diff --name-only f3f57c9..HEAD --diff-filter=d\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"The option “name-only” tells the command to only generate the name of the files. The second option “diff-filter=d” instructs the command to exclude deleted files."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"We have the following output immedidately:"}]},{type:a,value:c},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,l]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"file2.txt\nfolder1\u002Ffile1.txt\n"}]}]}]},{type:a,value:c},{type:b,tag:s,props:{id:"archive-the-generated-files"},children:[{type:b,tag:t,props:{ariaHidden:u,href:"#archive-the-generated-files",tabIndex:v},children:[{type:b,tag:e,props:{className:[w,x]},children:[]}]},{type:a,value:"Archive the generated files"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"We have the list of files to be archived now. We will then use the list of files for the second half of the command to create the zip file."}]},{type:a,value:c},{type:b,tag:f,props:{className:[g]},children:[{type:b,tag:h,props:{className:[i,l]},children:[{type:b,tag:j,props:{},children:[{type:a,value:"git archive --output=deployment-v1.zip HEAD $(git diff --name-only f3f57c9..HEAD --diff-filter=d)\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"We provide the file name “deployment-v1” in the “output” option. At this point the command is aware of the files to be archived, but how does it know up to which commit should the content of the files be updated to? This is where we provide the parameter “HEAD” as the reference point. That also means if we provide any other commit ID as the parameter, the content of the archived files to be different."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Finally we have a zip file called “deployment-v1.zip” with the created and modified files."}]}]},title:"Export Changed Files Between Two Commits",createdAt:"2022-07-03T08:06:02.322Z",updatedAt:"2022-09-13T12:26:04.501Z",summary:"Prepare a package that includes only the changed files between two commits",type:y,tags:["Git"]}],fetch:{},mutations:y}}("text","element","\n","p","span","div","nuxt-content-highlight","pre","line-numbers","code","token","language-text","function","variable","git","operator","=","li","h1","a","true",-1,"icon","icon-link",void 0)));